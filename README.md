# ç¤¾äº¤åª’é«”å…§å®¹ç”Ÿæˆç³»çµ±

åŸºæ–¼ A2A + MCP å¤šä»£ç†å”åŒæ¶æ§‹çš„æ™ºèƒ½å…§å®¹å‰µä½œå¹³å°

## å°ˆæ¡ˆæ¦‚è¿°

æœ¬ç³»çµ±æ¡ç”¨å‰æ²¿çš„ A2A (Agent-to-Agent) + MCP (Model Context Protocol) æ¶æ§‹ï¼Œå°‡ç¤¾äº¤åª’é«”å…§å®¹ç”Ÿæˆæµç¨‹æ‹†åˆ†ç‚ºå¤šå€‹å°ˆæ¥­åŒ–çš„ AI Agentï¼Œå¯¦ç¾é«˜åº¦æ¨¡çµ„åŒ–ã€å¯æ“´å±•çš„æ™ºèƒ½å…§å®¹å‰µä½œã€‚

### æ ¸å¿ƒåŠŸèƒ½

- ğŸ•·ï¸ **æ™ºèƒ½çˆ¬èŸ²**ï¼šåŸºæ–¼ Apify Threads Actor çš„ç¤¾äº¤åª’é«”å…§å®¹æŠ“å–
- ğŸ¯ **å¤šæ¨¡æ…‹åˆ†æ**ï¼šGemini 2.5 Pro é©…å‹•çš„åœ–ç‰‡/å½±ç‰‡å…§å®¹ç†è§£
- ğŸ“Š **æ™ºèƒ½æ’åº**ï¼šåŸºæ–¼ç€è¦½æ•¸çš„é«˜å½±éŸ¿åŠ›å…§å®¹è­˜åˆ¥
- ğŸ§  **é¢¨æ ¼åˆ†æ**ï¼šä¸‰ç¨®æ¨¡å¼çš„å…§å®¹é¢¨æ ¼æ·±åº¦è§£æ
- âœï¸ **äº’å‹•ç”Ÿæˆ**ï¼šå¤šè¼ªå°è©±å¼çš„å€‹æ€§åŒ–å…§å®¹å‰µä½œ
- ğŸ·ï¸ **è‡ªå‹•æ¨™ç±¤**ï¼šæ™ºèƒ½ Hashtag å»ºè­°å’Œå„ªåŒ–

### æŠ€è¡“æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Streamlit UI  â”‚    â”‚  Orchestrator   â”‚    â”‚   MCP Server    â”‚
â”‚                 â”‚â—„â”€â”€â–ºâ”‚     Agent       â”‚â—„â”€â”€â–ºâ”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚           â”‚           â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Crawler   â”‚ â”‚ Analysis  â”‚ â”‚ Content   â”‚
            â”‚  Agent    â”‚ â”‚  Agent    â”‚ â”‚ Writer    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¿«é€Ÿé–‹å§‹

### ç’°å¢ƒè¦æ±‚

- Python 3.11+
- Docker & Docker Compose
- PostgreSQL 15+
- Redis 7+

### å®‰è£æ­¥é©Ÿ

1. **å…‹éš†å°ˆæ¡ˆ**
```bash
git clone <repository-url>
cd social-media-content-generator
```

2. **è¨­ç½®ç’°å¢ƒè®Šæ•¸**
```bash
cp .env.example .env
# ç·¨è¼¯ .env æª”æ¡ˆï¼Œå¡«å…¥å¿…è¦çš„ API é‡‘é‘°
```

3. **å•Ÿå‹•æœå‹™**
```bash
docker-compose up -d
```

4. **å®‰è£ä¾è³´**
```bash
# åŸºç¤åŠŸèƒ½ï¼ˆçˆ¬èŸ²ï¼‰
pip install -e .

# æˆ–å®‰è£å®Œæ•´åŠŸèƒ½
pip install -e .[full]
```

5. **å•Ÿå‹•ç³»çµ±**
```bash
# å•Ÿå‹• MCP Server
python mcp_server/server.py

# å•Ÿå‹•å„å€‹ Agentï¼ˆåœ¨ä¸åŒçµ‚ç«¯ï¼‰
python agents/crawler/main.py
python agents/analysis/main.py
python agents/content_writer/main.py
python agents/orchestrator/main.py

# å•Ÿå‹• UI
streamlit run ui/app.py
```

## ç’°å¢ƒé…ç½®

### å¿…è¦çš„ API é‡‘é‘°

```env
# Apify é…ç½®
APIFY_TOKEN=your_apify_token_here

# Gemini AI é…ç½®
GEMINI_API_KEY=your_gemini_api_key_here

# è³‡æ–™åº«é…ç½®
DATABASE_URL=postgresql://user:password@localhost:5432/social_media_db

# Redis é…ç½®
REDIS_URL=redis://localhost:6379

# NATS é…ç½®
NATS_URL=nats://localhost:4222
```

### å¯é¸é…ç½®

```env
# OpenTelemetry è¿½è¹¤
JAEGER_ENDPOINT=http://localhost:14268/api/traces

# æ—¥èªŒç­‰ç´š
LOG_LEVEL=INFO

# Token ä½¿ç”¨é‡é™åˆ¶
MAX_TOKENS_PER_DAY=1000000
```

## ä½¿ç”¨æŒ‡å—

### åŸºæœ¬å·¥ä½œæµç¨‹

1. **ç™»å…¥ç³»çµ±**ï¼šä½¿ç”¨å¸³è™Ÿå¯†ç¢¼ç™»å…¥
2. **è¨­ç½® API é‡‘é‘°**ï¼šé…ç½® Apify å’Œ Gemini API é‡‘é‘°
3. **æŠ“å–å…§å®¹**ï¼šè¼¸å…¥ç›®æ¨™ Threads ç”¨æˆ¶åï¼ŒæŠ“å–è²¼æ–‡
4. **åˆ†æå…§å®¹**ï¼šé¸æ“‡åˆ†ææ¨¡å¼ï¼ˆå¿«é€Ÿ/é¢¨æ ¼/æ·±åº¦ï¼‰
5. **ç”Ÿæˆå…§å®¹**ï¼šåŸºæ–¼åˆ†æçµæœäº’å‹•å¼ç”Ÿæˆæ–°è²¼æ–‡
6. **å„ªåŒ–èª¿æ•´**ï¼šå¤šè¼ªå°è©±å„ªåŒ–å…§å®¹è³ªé‡

### ä¸‰ç¨®åˆ†ææ¨¡å¼

- **å¿«é€Ÿæ¨¡ä»¿**ï¼šåŸºç¤é¢¨æ ¼ç‰¹å¾µåˆ†æï¼Œé©åˆå¿«é€ŸåŸå‹
- **é¢¨æ ¼è§£æ**ï¼šæ·±å…¥èªè¨€é¢¨æ ¼åˆ†æï¼Œé©åˆå“ç‰Œä¸€è‡´æ€§
- **æ·±åº¦æ–‡æ¡ˆ**ï¼šå®Œæ•´å‰µæ„æ‰‹æ³•åˆ†æï¼Œé©åˆå°ˆæ¥­å‰µä½œ

## é–‹ç™¼æŒ‡å—

### å°ˆæ¡ˆçµæ§‹

```
social-media-content-generator/
â”œâ”€â”€ agents/                 # å„å€‹ AI Agent
â”‚   â”œâ”€â”€ crawler/           # çˆ¬èŸ²ä»£ç†
â”‚   â”œâ”€â”€ analysis/          # åˆ†æä»£ç†
â”‚   â”œâ”€â”€ content_writer/    # å…§å®¹ç”Ÿæˆä»£ç†
â”‚   â””â”€â”€ orchestrator/      # å”èª¿ä»£ç†
â”œâ”€â”€ mcp_server/            # MCP æœå‹™è¨»å†Šä¸­å¿ƒ
â”œâ”€â”€ ui/                    # Streamlit ç”¨æˆ¶ä»‹é¢
â”œâ”€â”€ common/                # å…±ç”¨æ¨¡çµ„
â”œâ”€â”€ tests/                 # æ¸¬è©¦æª”æ¡ˆ
â””â”€â”€ docs/                  # æ–‡æª”
```

### æ·»åŠ æ–° Agent

1. åœ¨ `agents/` ç›®éŒ„ä¸‹å‰µå»ºæ–°çš„ Agent è³‡æ–™å¤¾
2. å¯¦ç¾ `main.py`ï¼ˆFastAPI + A2A handlerï¼‰
3. å‰µå»º `agent_card.json`ï¼ˆMCP è¨»å†Šå¡ç‰‡ï¼‰
4. åœ¨ MCP Server ä¸­è¨»å†Šæ–° Agent

### æ¸¬è©¦

```bash
# é‹è¡Œæ‰€æœ‰æ¸¬è©¦
pytest

# é‹è¡Œç‰¹å®šæ¸¬è©¦
pytest tests/test_crawler.py

# é‹è¡Œæ•´åˆæ¸¬è©¦
pytest tests/integration/
```

## ç›£æ§èˆ‡ç¶­è­·

### å¥åº·æª¢æŸ¥

```bash
# æª¢æŸ¥æ‰€æœ‰æœå‹™ç‹€æ…‹
curl http://localhost:8000/health

# æª¢æŸ¥ç‰¹å®š Agent
curl http://localhost:8001/health  # Crawler Agent
curl http://localhost:8002/health  # Analysis Agent
```

### æ—¥èªŒæŸ¥çœ‹

```bash
# æŸ¥çœ‹ç³»çµ±æ—¥èªŒ
docker-compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœå‹™æ—¥èªŒ
docker-compose logs -f mcp-server
```

### æ€§èƒ½ç›£æ§

è¨ªå• Jaeger UIï¼šhttp://localhost:16686

## æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

1. **Agent ç„¡æ³•è¨»å†Šåˆ° MCP**
   - æª¢æŸ¥ MCP Server æ˜¯å¦æ­£å¸¸é‹è¡Œ
   - ç¢ºèª Agent Card æ ¼å¼æ­£ç¢º

2. **Apify æŠ“å–å¤±æ•—**
   - æª¢æŸ¥ API Token æ˜¯å¦æœ‰æ•ˆ
   - ç¢ºèªç›®æ¨™ç”¨æˆ¶åæ˜¯å¦å­˜åœ¨

3. **Gemini API èª¿ç”¨å¤±æ•—**
   - æª¢æŸ¥ API é‡‘é‘°æ˜¯å¦æ­£ç¢º
   - ç¢ºèª Token é…é¡æ˜¯å¦å……è¶³

### æ”¯æ´

å¦‚éœ€æŠ€è¡“æ”¯æ´ï¼Œè«‹ï¼š
1. æŸ¥çœ‹ [æ•…éšœæ’é™¤æŒ‡å—](docs/troubleshooting.md)
2. æª¢æŸ¥ [å¸¸è¦‹å•é¡Œ](docs/faq.md)
3. æäº¤ Issue æˆ–è¯ç¹«é–‹ç™¼åœ˜éšŠ

## æˆæ¬Š

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Šæ¢æ¬¾ã€‚è©³è¦‹ [LICENSE](LICENSE) æª”æ¡ˆã€‚

## è²¢ç»

æ­¡è¿è²¢ç»ï¼è«‹é–±è®€ [è²¢ç»æŒ‡å—](CONTRIBUTING.md) äº†è§£å¦‚ä½•åƒèˆ‡é–‹ç™¼ã€‚

---

**ç‰ˆæœ¬**: v1.0.0  
**æœ€å¾Œæ›´æ–°**: 2025-01-23  
**ç¶­è­·è€…**: é–‹ç™¼åœ˜éšŠ