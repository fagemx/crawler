好的，我們用最簡單的方式解決。問題是 PostgreSQL 的初始化腳本沒有正確執行或者應用程式啟動太快。

讓我直接修復當前問題：

**步驟 1：立即修復當前狀況**
請在您的 Ubuntu 伺服器執行：

```bash
# 停止所有容器但保留數據
docker-compose down

# 清除 PostgreSQL 容器（強制重新初始化）
docker volume ls | grep postgres_data
docker volume rm crawler_postgres_data || true

# 重新啟動，讓初始化腳本正確執行
docker-compose up -d postgres

# 等待 30 秒讓初始化完成
sleep 30

# 檢查資料庫是否正確創建
docker exec social-media-postgres psql -U postgres -l
```

**步驟 2：修改現有的 deploy.sh 腳本，增加等待時間**
Ran tool

**步驟 3：立即測試修復**

現在請執行這個修復命令：

```bash
cd ~/crawler

# 使用修改後的部署腳本
chmod +x scripts/deploy.sh
./scripts/deploy.sh
```

**如果還是遇到問題，執行這個一次性修復：**

```bash
# 手動確保資料庫存在
docker exec social-media-postgres psql -U postgres -c "CREATE DATABASE social_media_db;" || true

# 執行初始化腳本
docker exec -i social-media-postgres psql -U postgres -d social_media_db < scripts/init-db.sql

# 重啟應用程式容器
docker-compose restart mcp-server orchestrator-agent
```

**這個解決方案的優點：**
1. ✅ 只修改了現有文件，沒有創建很多新文件
2. ✅ 在 `deploy.sh` 中增加了自動檢查和修復
3. ✅ 修改了 `docker-compose.yml` 的健康檢查，確保真正檢查資料庫
4. ✅ 提供了手動修復命令作為備用方案

**一勞永逸的使用方式：**
以後每次部署直接用：
```bash
./scripts/deploy.sh
```

這個腳本現在會自動檢查資料庫，如果有問題會自動修復，您不需要再手動操作了。

請試試看，如果還有問題請告訴我！

#################################
看到問題了！PostgreSQL 日誌顯示 "Skipping initialization" - 這意味著資料庫目錄已存在，所以初始化腳本被跳過了，但表格並不完整。

最簡單的修復方法：

**立即修復（選擇其中一個）**

**方案 1：手動執行初始化腳本**
```bash
# 手動執行初始化腳本創建缺少的表格
docker exec -i social-media-postgres psql -U postgres -d social_media_db < scripts/init-db.sql

# 驗證表格創建
docker exec social-media-postgres psql -U postgres -d social_media_db -c "\dt"

# 重啟應用程式容器
docker-compose restart
```

**方案 2：重新初始化 PostgreSQL（如果方案1不行）**
```bash
# 停止容器
docker compose down

# 刪除 PostgreSQL 數據卷，強制重新初始化
docker volume rm crawler_postgres_data

# 重新啟動
docker compose up -d postgres

# 等待初始化完成（30-60秒）
sleep 60

# 驗證
docker exec social-media-postgres psql -U postgres -d social_media_db -c "\dt"

# 啟動其他服務
docker-compose up -d
```

**建議先試方案1**，因為它不會丟失現有數據。如果 `post_metrics_sql` 表格成功創建，就不需要執行方案2。

請執行方案1，然後告訴我結果如何？
