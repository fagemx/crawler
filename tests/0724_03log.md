å¤ªå¥½äº†ï¼ç¾åœ¨ pipeline å®Œå…¨æ­£å¸¸å·¥ä½œäº†ï¼ğŸ‰

è®“æˆ‘æ•´ç†ä¸€ä¸‹ç›¸é—œçš„æ ¸å¿ƒæª”æ¡ˆå’Œè³‡æ–™æµç¨‹ï¼š

## ğŸ“ **æ ¸å¿ƒç›¸é—œæª”æ¡ˆ**
Ran tool
## ğŸ” **ç›¸é—œæ ¸å¿ƒæª”æ¡ˆæ¸…å–®**

### 1ï¸âƒ£ **Pipeline å”èª¿å±¤**
- **`services/pipeline_service.py`** - ä¸»è¦å”èª¿æœå‹™
- **`common/config.py`** - é…ç½®ç®¡ç†ï¼ˆå¦‚æœå­˜åœ¨ï¼‰

### 2ï¸âƒ£ **Playwright Crawler Agent**
- **`agents/playwright_crawler/main.py`** - FastAPI ç«¯é»
- **`agents/playwright_crawler/playwright_logic.py`** - æ ¸å¿ƒçˆ¬èŸ²é‚è¼¯
- **`agents/playwright_crawler/Dockerfile`** - Docker é…ç½®

### 3ï¸âƒ£ **Jina Agent**
- **`agents/jina/main.py`** - FastAPI ç«¯é»
- **`agents/jina/jina_logic.py`** - æ ¸å¿ƒ Jina è™•ç†é‚è¼¯
- **`agents/jina/Dockerfile`** - Docker é…ç½®

### 4ï¸âƒ£ **å…±ç”¨æ¨¡çµ„**
- **`common/models.py`** - è³‡æ–™æ¨¡å‹ï¼ˆPostMetrics, PostMetricsBatchï¼‰
- **`common/settings.py`** - çµ±ä¸€è¨­å®šç®¡ç†
- **`common/db_client.py`** - è³‡æ–™åº«æ“ä½œ
- **`common/redis_client.py`** - Redis å¿«å–æ“ä½œ

è®“æˆ‘æª¢æŸ¥è³‡æ–™æœ€çµ‚å­˜å„²çš„ä½ç½®ï¼š
Ran tool
ç¾åœ¨è®“æˆ‘æª¢æŸ¥ç›®å‰çš„è³‡æ–™æµç¨‹ï¼š
Ran tool
è®“æˆ‘æª¢æŸ¥ pipeline_service.py çš„å®Œæ•´å…§å®¹ï¼Œçœ‹çœ‹è³‡æ–™æ˜¯å¦æœ‰è¢«å­˜å„²ï¼š
Read file: services/pipeline_service.py
## ğŸ¯ **æ ¸å¿ƒç™¼ç¾å’Œè§£ç­”**

### **ç›¸é—œæª”æ¡ˆæ¸…å–®**

| æª”æ¡ˆé¡åˆ¥ | æª”æ¡ˆè·¯å¾‘ | åŠŸèƒ½ |
|---------|----------|------|
| **å”èª¿å±¤** | `services/pipeline_service.py` | ä¸»è¦å”èª¿æœå‹™ |
| **Playwright Agent** | `agents/playwright_crawler/main.py` | FastAPI ç«¯é» |
|  | `agents/playwright_crawler/playwright_logic.py` | æ ¸å¿ƒçˆ¬èŸ²é‚è¼¯ |
| **Jina Agent** | `agents/jina/main.py` | FastAPI ç«¯é» |
|  | `agents/jina/jina_logic.py` | æ ¸å¿ƒ Jina è™•ç†é‚è¼¯ |
| **å…±ç”¨æ¨¡çµ„** | `common/models.py` | PostMetrics, PostMetricsBatch |
|  | `common/settings.py` | çµ±ä¸€è¨­å®šç®¡ç† |
|  | `common/db_client.py` | PostgreSQL æ“ä½œ |
|  | `common/redis_client.py` | Redis å¿«å–æ“ä½œ |

### **ğŸ“Š è§£æä¹‹å¾Œæœƒå­˜åœ¨å“ªè£¡ï¼Ÿ**

**é‡è¦ç™¼ç¾**ï¼šç›®å‰çš„ pipeline_service.py **ä¸¦æ²’æœ‰åŸ·è¡Œè³‡æ–™å­˜å„²**ï¼

ç¾åœ¨çš„æµç¨‹æ˜¯ï¼š
```
Playwright Crawler â†’ Jina Agent â†’ åƒ…å›å‚³çµ¦èª¿ç”¨è€…
```

ä½†æ˜¯æ ¹æ“š Plan E ä¸‰å±¤ç­–ç•¥ï¼Œæ‡‰è©²è¦å­˜å„²åˆ°ï¼š

#### **Tier-0 (Redis)**: è‡¨æ™‚å¿«å–
- **æŒ‡æ¨™å¿«å–**: `metrics:{url}` 
- **æ’åºå¿«å–**: `ranking:{username}`
- **ä»»å‹™ç‹€æ…‹**: `task:{task_id}`

#### **Tier-1 (PostgreSQL)**: é•·æœŸå­˜å„²  
- **posts è¡¨**: è²¼æ–‡åŸºæœ¬è³‡æ–™
- **post_metrics è¡¨**: æŒ‡æ¨™æ•¸æ“š
- **processing_log è¡¨**: è™•ç†è¨˜éŒ„

### **ğŸš¨ ç¼ºå°‘çš„å­˜å„²é‚è¼¯**

æˆ‘å€‘éœ€è¦åœ¨ `pipeline_service.py` ä¸­æ·»åŠ å­˜å„²é‚è¼¯ï¼è®“æˆ‘ç‚ºæ‚¨æ·»åŠ ï¼š
ç¾åœ¨æ·»åŠ å­˜å„²æ–¹æ³•ï¼š
ä½†æˆ‘å€‘éœ€è¦æª¢æŸ¥ `common/config.py` æ˜¯å¦å­˜åœ¨ï¼Œå› ç‚ºæœ‰å€‹å°å…¥éŒ¯èª¤ï¼š
Ran tool
å¾ˆå¥½ï¼ç¾åœ¨è®“æˆ‘å€‘æ¸¬è©¦æ–°çš„åŒ…å«å­˜å„²é‚è¼¯çš„ pipelineï¼š

## ğŸ“‹ **ç¸½çµ - ç›¸é—œæª”æ¡ˆå’Œè³‡æ–™æµç¨‹**

### **ğŸ”„ å®Œæ•´è³‡æ–™æµç¨‹**
```
1. Playwright Crawler â†’ çˆ¬å–åŸºæœ¬æŒ‡æ¨™ (likes, comments, reposts, shares)
2. Jina Agent â†’ è±å¯ŒåŒ– views æ•¸æ“š  
3. Pipeline Service â†’ å­˜å„²åˆ° PostgreSQL å’Œ Redis
   â”œâ”€â”€ PostgreSQL: posts è¡¨ + post_metrics è¡¨
   â””â”€â”€ Redis: metrics:{url} å¿«å–
```

### **ğŸ“ æ ¸å¿ƒæª”æ¡ˆ**
1. **`services/pipeline_service.py`** - å”èª¿å’Œå­˜å„²
2. **`agents/jina/jina_logic.py`** - Jina è™•ç†é‚è¼¯  
3. **`agents/playwright_crawler/playwright_logic.py`** - çˆ¬èŸ²é‚è¼¯
4. **`common/db_client.py`** - è³‡æ–™åº«æ“ä½œ
5. **`common/redis_client.py`** - Redis æ“ä½œ
6. **`common/models.py`** - è³‡æ–™æ¨¡å‹

ç¾åœ¨æˆ‘å€‘çš„ pipeline åŒ…å«å®Œæ•´çš„å­˜å„²é‚è¼¯ï¼è³‡æ–™æœƒåŒæ™‚å­˜åˆ° PostgreSQLï¼ˆé•·æœŸå­˜å„²ï¼‰å’Œ Redisï¼ˆå¿«å–ï¼‰ã€‚