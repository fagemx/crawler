太好了！現在資料庫和表格都已經存在了。讓我更新任務狀態並分析為什麼會出現這個問題，以及如何避免每次都要手動操作。
Ran tool

很好！資料庫和所有表格都已經存在了。現在讓我們測試應用程式是否能正常連接：

**請測試應用程式連接：**
```bash
docker logs --tail 20 social-media-postgres
```

然後嘗試啟動您的應用程式看看是否還有資料庫錯誤。

**關於您的問題「每次都要手動加入嗎？」**

不應該需要！問題出現的原因和解決方案：

## 🔍 問題分析

根據您的 `docker-compose.yml` 配置，初始化腳本應該自動執行：
```yaml
volumes:
  - ./scripts/init-db.sql:/docker-entrypoint-initdb.d/01-init-db.sql:ro
```

問題可能發生在：
1. **容器數據卷重置** - 如果執行了 `docker-compose down -v`
2. **啟動順序問題** - 應用程式在資料庫完全準備好之前就嘗試連接
3. **環境差異** - 開發環境和生產環境的設定不同

## 🛠️ 永久解決方案

讓我為您創建一個自動化檢查和修復腳本：
Ran tool

現在讓我創建一個部署腳本，確保每次部署時都會自動檢查和修復資料庫：
Ran tool

讓我再創建一個快速修復腳本，以防緊急情況：
Ran tool

Ran tool

## 🎉 完成！以下是避免每次手動修復的解決方案：

## 📝 **使用指南**

### 1. **日常部署** (推薦)
```bash
# 在您的 Ubuntu 伺服器上
cd ~/crawler
chmod +x scripts/deploy.sh
./scripts/deploy.sh
```
這個腳本會自動：
- 停止服務但保留數據
- 檢查和修復資料庫
- 按正確順序啟動所有服務
- 驗證連接

### 2. **緊急修復** (當出現資料庫錯誤時)
```bash
chmod +x scripts/quick_fix_database.sh
./scripts/quick_fix_database.sh
```

### 3. **只檢查資料庫** (預防性檢查)
```bash
chmod +x scripts/ensure_database.sh
./scripts/ensure_database.sh
```

## 🔧 **設置方法**

**一次性設置：**
```bash
# 在 Ubuntu 伺服器上
cd ~/crawler

# 下載更新的腳本（如果從 Windows 開發環境推送）
git pull  # 或其他同步方式

# 給腳本執行權限
chmod +x scripts/*.sh
```

## 🛡️ **為什麼會出現這個問題？**

1. **Docker 數據卷重置** - 執行 `docker-compose down -v` 會清除數據
2. **初始化時序問題** - 應用程式啟動太快，資料庫還沒完全準備好
3. **容器重啟** - 某些情況下容器重啟可能導致初始化腳本沒有執行

## 🎯 **建議的工作流程**

**從現在開始，每次部署時：**
```bash
# 代替手動 docker-compose up
./scripts/deploy.sh
```

**如果遇到資料庫錯誤：**
```bash
# 快速修復
./scripts/quick_fix_database.sh

# 然後重啟應用
docker-compose restart
```

這樣您就不需要每次都手動創建資料庫了！腳本會自動檢查並在需要時進行修復。

您想要測試一下這些腳本嗎？建議您先試試 `./scripts/ensure_database.sh` 確認一切正常。