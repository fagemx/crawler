# ğŸ”§ CSV é è¦½è³‡æ–™æ¨¡æ¿ä¿®å¾©å ±å‘Š

## âŒ **åŸå§‹å•é¡Œ**

ç”¨æˆ¶åé¥‹ï¼š
```
Playwright çˆ¬èŸ² ä¸‹é¢å°å‡ºçš„CSVé è¦½ é¸æ“‡ ç™¼å¸ƒæ™‚é–“
ä½†æ˜¯CSV é è¦½ä¸Šé¢ æ²’æœ‰ç™¼å¸ƒæ™‚é–“ æ¬„ä½
é€™æ¨£è¨ˆç®—æ’åˆ—åŸºæ–¼ä»€éº¼??
ç‚ºä½•ä¸è·Ÿé¡¯ç¤ºè©³ç´°çµæœ ä½¿ç”¨ä¸€æ¨£çš„è³‡æ–™æ¨¡æ¿å°±å¥½?
```

## ğŸ” **å•é¡Œåˆ†æ**

### **è³‡æ–™æ¨¡æ¿ä¸ä¸€è‡´**
ç™¼ç¾å…©å€‹åœ°æ–¹ä½¿ç”¨äº†ä¸åŒçš„è³‡æ–™æ¨¡æ¿ï¼š

#### **1. "é¡¯ç¤ºè©³ç´°çµæœ" æ¨¡æ¿** âœ…
åœ¨ `ui/components/playwright_crawler_component_v2.py` ä¸­ï¼š
```python
# å®Œæ•´çš„è³‡æ–™æ¬„ä½
{
    "è²¼æ–‡ID": post_id,
    "å…§å®¹": content,
    "è§€çœ‹æ•¸": views_count,
    "æŒ‰è®šæ•¸": likes_count,
    "åˆ†æ•¸": calculated_score,
    "ç™¼å¸ƒæ™‚é–“": published_taipei,  # âœ… æœ‰ç™¼å¸ƒæ™‚é–“
    "çˆ¬å–æ™‚é–“": created_taipei,    # âœ… æœ‰çˆ¬å–æ™‚é–“
    # ... å…¶ä»–æ¬„ä½
}
```

#### **2. CSV é è¦½æ¨¡æ¿** âŒ
åœ¨ `ui/components/playwright_data_export_handler.py` ä¸­ï¼š
```python
# ä¿®å¾©å‰ï¼šç¼ºå°‘ç™¼å¸ƒæ™‚é–“
{
    "#": i,
    "è²¼æ–‡ID": post_id,
    "å…§å®¹é è¦½": content_preview,
    "è§€çœ‹æ•¸": views_count,
    "æŒ‰è®šæ•¸": likes_count,
    "åˆ†æ•¸": calculated_score,
    "çˆ¬å–æ™‚é–“": fetched_at    # âŒ æ²’æœ‰ç™¼å¸ƒæ™‚é–“
}
```

### **é‚è¼¯ä¸ä¸€è‡´å•é¡Œ**
- **æ’åºé¸é …**ï¼šåŒ…å«"ç™¼å¸ƒæ™‚é–“"ä½œç‚ºæ’åºä¾æ“š
- **é è¦½é¡¯ç¤º**ï¼šä½†CSVé è¦½ä¸­æ²’æœ‰é¡¯ç¤ºç™¼å¸ƒæ™‚é–“æ¬„ä½
- **ç”¨æˆ¶å›°æƒ‘**ï¼šä¸çŸ¥é“"ç™¼å¸ƒæ™‚é–“"æ’åºæ˜¯åŸºæ–¼ä»€éº¼

## âœ… **ä¿®å¾©æ–¹æ¡ˆ**

### **çµ±ä¸€è³‡æ–™æ¨¡æ¿**
å°‡CSVé è¦½çš„è³‡æ–™æ¨¡æ¿ä¿®æ”¹ç‚ºèˆ‡"é¡¯ç¤ºè©³ç´°çµæœ"ä¸€è‡´ï¼š

```python
# ä¿®å¾©å¾Œï¼šå®Œæ•´çš„è³‡æ–™æ¨¡æ¿
preview_data.append({
    "#": i,
    "è²¼æ–‡ID": post_id_display,
    "å…§å®¹é è¦½": content_display,
    "è§€çœ‹æ•¸": views_count_formatted,
    "æŒ‰è®šæ•¸": likes_count_formatted,
    "åˆ†æ•¸": calculated_score_formatted,
    "ç™¼å¸ƒæ™‚é–“": published_display,  # âœ… æ–°å¢ç™¼å¸ƒæ™‚é–“
    "çˆ¬å–æ™‚é–“": fetched_display     # âœ… æ”¹é€²çˆ¬å–æ™‚é–“
})
```

### **æ™‚é–“è™•ç†æ”¹é€²**
æ·»åŠ äº†æ™ºèƒ½æ™‚é–“æ ¼å¼åŒ–ï¼š

```python
# ç™¼å¸ƒæ™‚é–“è™•ç†
published_at = post.get('post_published_at', '')
if published_at:
    try:
        taipei_published = PlaywrightUtils.convert_to_taipei_time(published_at)
        published_display = taipei_published.strftime('%Y-%m-%d %H:%M') if taipei_published else str(published_at)[:16]
    except:
        published_display = str(published_at)[:16] if published_at else 'N/A'
else:
    published_display = 'N/A'

# çˆ¬å–æ™‚é–“è™•ç†
fetched_at = post.get('fetched_at', '')
if fetched_at:
    try:
        taipei_fetched = PlaywrightUtils.convert_to_taipei_time(fetched_at)
        fetched_display = taipei_fetched.strftime('%Y-%m-%d %H:%M') if taipei_fetched else str(fetched_at)[:16]
    except:
        fetched_display = str(fetched_at)[:16] if fetched_at else 'N/A'
else:
    fetched_display = 'N/A'
```

## ğŸ¯ **ä¿®å¾©æ•ˆæœ**

### **ä¿®å¾©å‰çš„å•é¡Œ**ï¼š
```bash
âŒ CSVé è¦½ç¼ºå°‘ç™¼å¸ƒæ™‚é–“æ¬„ä½
âŒ ç„¡æ³•ç†è§£"ç™¼å¸ƒæ™‚é–“"æ’åºçš„ä¾æ“š
âŒ è³‡æ–™æ¨¡æ¿ä¸ä¸€è‡´
âŒ æ™‚é–“æ ¼å¼è™•ç†ç°¡é™‹
âŒ ç”¨æˆ¶é«”é©—æ··æ·†
```

### **ä¿®å¾©å¾Œçš„æ”¹é€²**ï¼š
```bash
âœ… CSVé è¦½åŒ…å«å®Œæ•´çš„ç™¼å¸ƒæ™‚é–“æ¬„ä½
âœ… æ¸…æ¥šé¡¯ç¤º"ç™¼å¸ƒæ™‚é–“"æ’åºçš„ä¾æ“š
âœ… è³‡æ–™æ¨¡æ¿å®Œå…¨ä¸€è‡´
âœ… æ™ºèƒ½æ™‚é–“æ ¼å¼åŒ–ï¼ˆå°åŒ—æ™‚å€ï¼‰
âœ… ä¸€è‡´çš„ç”¨æˆ¶é«”é©—
```

## ğŸ“Š **ç¾åœ¨çš„CSVé è¦½æ¬„ä½**

ä¿®å¾©å¾Œï¼ŒCSVé è¦½åŒ…å«ä»¥ä¸‹å®Œæ•´æ¬„ä½ï¼š

| # | æ¬„ä½ | æ ¼å¼ | èªªæ˜ |
|---|------|------|------|
| 1 | **#** | æ•¸å­— | é è¦½åºè™Ÿ |
| 2 | **è²¼æ–‡ID** | æ–‡å­— | æˆªçŸ­é¡¯ç¤º |
| 3 | **å…§å®¹é è¦½** | æ–‡å­— | å¯é¸å®Œæ•´/é è¦½ |
| 4 | **è§€çœ‹æ•¸** | æ ¼å¼åŒ–æ•¸å­— | åƒåˆ†ä½åˆ†éš” |
| 5 | **æŒ‰è®šæ•¸** | æ ¼å¼åŒ–æ•¸å­— | åƒåˆ†ä½åˆ†éš” |
| 6 | **åˆ†æ•¸** | æ ¼å¼åŒ–æ•¸å­— | ä¸€ä½å°æ•¸ |
| 7 | **ç™¼å¸ƒæ™‚é–“** | å°åŒ—æ™‚é–“ | âœ… æ–°å¢ï¼æ ¼å¼ï¼šYYYY-MM-DD HH:MM |
| 8 | **çˆ¬å–æ™‚é–“** | å°åŒ—æ™‚é–“ | âœ… æ”¹é€²ï¼æ ¼å¼ï¼šYYYY-MM-DD HH:MM |

## ğŸ”„ **æ’åºé‚è¼¯ä¸€è‡´æ€§**

ç¾åœ¨æ’åºé¸é …èˆ‡é è¦½é¡¯ç¤ºå®Œå…¨å°æ‡‰ï¼š

### **æ’åºé¸é …** â†” **é è¦½æ¬„ä½**
- âœ… **ç™¼å¸ƒæ™‚é–“** â†” **ç™¼å¸ƒæ™‚é–“æ¬„ä½**
- âœ… **çˆ¬å–æ™‚é–“** â†” **çˆ¬å–æ™‚é–“æ¬„ä½**
- âœ… **è§€çœ‹æ•¸** â†” **è§€çœ‹æ•¸æ¬„ä½**
- âœ… **æŒ‰è®šæ•¸** â†” **æŒ‰è®šæ•¸æ¬„ä½**
- âœ… **è¨ˆç®—åˆ†æ•¸** â†” **åˆ†æ•¸æ¬„ä½**

### **æ™‚é–“æ ¼å¼æ¨™æº–åŒ–**
- **å°åŒ—æ™‚å€**ï¼šæ‰€æœ‰æ™‚é–“éƒ½è½‰æ›ç‚ºå°åŒ—æ™‚å€
- **çµ±ä¸€æ ¼å¼**ï¼š`YYYY-MM-DD HH:MM`
- **éŒ¯èª¤è™•ç†**ï¼šç„¡æ•ˆæ™‚é–“é¡¯ç¤ºç‚º 'N/A'

## ğŸš€ **ç”¨æˆ¶é«”é©—æå‡**

### **æ¸…æ™°çš„æ’åºä¾æ“š**
- ç”¨æˆ¶é¸æ“‡"ç™¼å¸ƒæ™‚é–“"æ’åº â†’ å¯ä»¥åœ¨é è¦½ä¸­çœ‹åˆ°ç™¼å¸ƒæ™‚é–“æ¬„ä½
- æ’åºçµæœèˆ‡é è¦½é¡¯ç¤ºé‚è¼¯ä¸€è‡´
- ä¸å†æœ‰"æ’åºåŸºæ–¼ä»€éº¼"çš„å›°æƒ‘

### **ä¸€è‡´çš„è³‡æ–™æ¨¡æ¿**
- CSVé è¦½ = è©³ç´°çµæœé¡¯ç¤º
- ç›¸åŒçš„æ¬„ä½åç¨±å’Œæ ¼å¼
- çµ±ä¸€çš„æ™‚é–“è™•ç†é‚è¼¯

### **æ›´å¥½çš„è³‡è¨Šå®Œæ•´æ€§**
- åŒ…å«ç™¼å¸ƒæ™‚é–“å’Œçˆ¬å–æ™‚é–“
- æä¾›å®Œæ•´çš„è²¼æ–‡è³‡è¨Šæ¦‚è¦½
- æ–¹ä¾¿ç”¨æˆ¶åœ¨å°å‡ºå‰é è¦½æ•¸æ“š

---

**ä¿®å¾©å®Œæˆæ™‚é–“**ï¼š2025-08-07  
**å½±éŸ¿ç¯„åœ**ï¼š`ui/components/playwright_data_export_handler.py`  
**ä¿®å¾©é¡å‹**ï¼šè³‡æ–™æ¨¡æ¿çµ±ä¸€ + æ™‚é–“è™•ç†æ”¹é€² + ç”¨æˆ¶é«”é©—æå‡
