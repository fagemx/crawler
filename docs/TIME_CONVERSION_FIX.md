# ğŸ”§ æ™‚é–“è½‰æ›éŒ¯èª¤ä¿®å¾©å ±å‘Š

## âŒ **åŸå§‹éŒ¯èª¤**

ç”¨æˆ¶åé¥‹çš„éŒ¯èª¤æ—¥èªŒï¼š
```bash
âš ï¸ æ™‚é–“è½‰æ›å¤±æ•— 2025-07-28 01:57:31: 'str' object cannot be interpreted as an integer
âš ï¸ æ™‚é–“è½‰æ›å¤±æ•— 2025-08-06 20:58:48.063065: 'str' object cannot be interpreted as an integer
âš ï¸ æ™‚é–“è½‰æ›å¤±æ•— 2025-08-07 04:07:39.690356: 'str' object cannot be interpreted as an integer
âš ï¸ æ™‚é–“è½‰æ›å¤±æ•— 2024-02-23 18:13:24: 'str' object cannot be interpreted as an integer
âš ï¸ æ™‚é–“è½‰æ›å¤±æ•— 2025-08-06 20:10:44.955344: 'str' object cannot be interpreted as an integer
```

## ğŸ” **å•é¡Œåˆ†æ**

### **æ ¹æœ¬åŸå› **
`PlaywrightUtils.convert_to_taipei_time()` å‡½æ•¸åªèƒ½è™•ç†æ¨™æº–ISOæ ¼å¼çš„æ™‚é–“å­—ç¬¦ä¸²ï¼Œä½†å¯¦éš›æ•¸æ“šä¸­åŒ…å«å¤šç¨®æ™‚é–“æ ¼å¼ï¼š

#### **åŸå‡½æ•¸é™åˆ¶**
```python
# ä¿®å¾©å‰ï¼šåªæ”¯æŒISOæ ¼å¼
dt = datetime.fromisoformat(datetime_str.replace('Z', '+00:00'))
```

#### **å¯¦éš›é‡åˆ°çš„æ ¼å¼**
1. `2025-07-28 01:57:31` - æ¨™æº–æ ¼å¼ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰
2. `2025-08-06 20:58:48.063065` - å¸¶å¾®ç§’ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰
3. `2025-08-07 04:07:39.690356` - å¸¶å¾®ç§’ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰
4. `2024-02-23 18:13:24` - æ¨™æº–æ ¼å¼ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰
5. `2025-08-06 20:10:44.955344` - å¸¶å¾®ç§’ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰

### **éŒ¯èª¤åŸå› **
`datetime.fromisoformat()` æœŸæœ› ISO æ ¼å¼ (`YYYY-MM-DDTHH:MM:SS`)ï¼Œä½†æ”¶åˆ°çš„æ˜¯ `YYYY-MM-DD HH:MM:SS` æ ¼å¼ï¼ˆä½¿ç”¨ç©ºæ ¼è€Œä¸æ˜¯Tï¼‰ï¼Œå°è‡´è§£æå¤±æ•—ã€‚

## âœ… **ä¿®å¾©æ–¹æ¡ˆ**

### **å¤šæ ¼å¼æ™‚é–“è§£æ**
é‡æ–°è¨­è¨ˆ `convert_to_taipei_time()` å‡½æ•¸ï¼Œæ”¯æŒå¤šç¨®æ™‚é–“æ ¼å¼ï¼š

```python
def convert_to_taipei_time(datetime_str: str) -> datetime:
    """å°‡å„ç¨®æ ¼å¼çš„æ—¥æœŸæ™‚é–“å­—ç¬¦ä¸²è½‰æ›ç‚ºå°åŒ—æ™‚å€çš„ datetime ç‰©ä»¶"""
    
    # æ–¹æ³•1ï¼šå˜—è©¦ ISO æ ¼å¼
    try:
        dt = datetime.fromisoformat(datetime_str.replace('Z', '+00:00'))
    except ValueError:
        pass
    
    # æ–¹æ³•2ï¼šå˜—è©¦æ¨™æº–æ ¼å¼ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰
    if dt is None:
        try:
            # "YYYY-MM-DD HH:MM:SS" æ ¼å¼
            if len(datetime_str) == 19 and ' ' in datetime_str:
                dt = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M:%S')
            # "YYYY-MM-DD HH:MM:SS.ffffff" æ ¼å¼
            elif '.' in datetime_str and ' ' in datetime_str:
                # è™•ç†å¾®ç§’éƒ¨åˆ†ï¼ˆç¢ºä¿6ä½ï¼‰
                base_part, micro_part = datetime_str.split('.')
                micro_part = micro_part[:6].ljust(6, '0')
                datetime_str = f"{base_part}.{micro_part}"
                dt = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M:%S.%f')
        except ValueError:
            pass
    
    # æ–¹æ³•3ï¼šå˜—è©¦æ›¿æ›Tç‚ºç©ºæ ¼å¾Œè§£æ
    if dt is None:
        try:
            modified_str = datetime_str.replace('T', ' ')
            # ... æ›´å¤šè§£æé‚è¼¯
        except ValueError:
            pass
```

### **æ”¯æ´çš„æ™‚é–“æ ¼å¼**
ä¿®å¾©å¾Œæ”¯æ´ä»¥ä¸‹æ‰€æœ‰æ ¼å¼ï¼š

| æ ¼å¼ | ç¯„ä¾‹ | èªªæ˜ |
|------|------|------|
| **ISOæ¨™æº–** | `2025-07-28T01:57:31` | åŸæœ¬æ”¯æ´ |
| **ISO+æ™‚å€** | `2025-07-28T01:57:31Z` | åŸæœ¬æ”¯æ´ |
| **ç©ºæ ¼åˆ†éš”** | `2025-07-28 01:57:31` | âœ… æ–°æ”¯æ´ |
| **å¸¶å¾®ç§’** | `2025-08-06 20:58:48.063065` | âœ… æ–°æ”¯æ´ |
| **è®Šé•·å¾®ç§’** | `2025-08-07 04:07:39.69` | âœ… æ–°æ”¯æ´ |
| **æ··åˆæ ¼å¼** | `2025-07-28T01:57:31.123456` | âœ… æ–°æ”¯æ´ |

### **å¼·åŒ–éŒ¯èª¤è™•ç†**
åœ¨CSVé è¦½é¡¯ç¤ºä¸­æ·»åŠ äº†é›™é‡éŒ¯èª¤è™•ç†ï¼š

```python
# ç¬¬ä¸€å±¤ï¼šæ™‚é–“è½‰æ›éŒ¯èª¤è™•ç†
taipei_published = PlaywrightUtils.convert_to_taipei_time(published_at)
if taipei_published:
    published_display = taipei_published.strftime('%Y-%m-%d %H:%M')
else:
    # ç¬¬äºŒå±¤ï¼šå›é€€åˆ°å­—ç¬¦ä¸²æˆªå–
    published_display = str(published_at)[:16]
```

## ğŸ¯ **ä¿®å¾©æ•ˆæœ**

### **ä¿®å¾©å‰çš„éŒ¯èª¤è¡Œç‚º**ï¼š
```bash
âŒ åªæ”¯æ´ISOæ ¼å¼æ™‚é–“
âŒ é‡åˆ°ç©ºæ ¼åˆ†éš”æ ¼å¼å°±å¤±æ•—
âŒ å¾®ç§’è™•ç†ä¸ç•¶
âŒ å¤§é‡æ™‚é–“è½‰æ›å¤±æ•—è­¦å‘Š
âŒ CSVé è¦½æ™‚é–“é¡¯ç¤ºç‚º'N/A'
```

### **ä¿®å¾©å¾Œçš„æ­£ç¢ºè¡Œç‚º**ï¼š
```bash
âœ… æ”¯æ´å¤šç¨®æ™‚é–“æ ¼å¼
âœ… æ™ºèƒ½æ ¼å¼æª¢æ¸¬å’Œè§£æ
âœ… æ­£ç¢ºè™•ç†å¾®ç§’ç²¾åº¦
âœ… ç„¡æ™‚é–“è½‰æ›å¤±æ•—è­¦å‘Š
âœ… CSVé è¦½æ­£ç¢ºé¡¯ç¤ºæ™‚é–“
```

## ğŸ”„ **æ™‚é–“è™•ç†æµç¨‹**

### **æ–°çš„è§£ææµç¨‹**
```
è¼¸å…¥æ™‚é–“å­—ç¬¦ä¸²
    â†“
1. å˜—è©¦ISOæ ¼å¼è§£æ
    â†“ (å¤±æ•—)
2. å˜—è©¦ç©ºæ ¼åˆ†éš”æ ¼å¼
    â†“ (å¤±æ•—)
3. å˜—è©¦æ›¿æ›Tç‚ºç©ºæ ¼
    â†“ (å¤±æ•—)
4. è¿”å›Noneä¸¦è¨˜éŒ„éŒ¯èª¤
    â†“
5. å›é€€åˆ°å­—ç¬¦ä¸²æˆªå–é¡¯ç¤º
```

### **å¾®ç§’è™•ç†**
```python
# æ™ºèƒ½å¾®ç§’è™•ç†
if '.' in datetime_str:
    base_part, micro_part = datetime_str.split('.')
    micro_part = micro_part[:6].ljust(6, '0')  # ç¢ºä¿6ä½å¾®ç§’
    datetime_str = f"{base_part}.{micro_part}"
```

## ğŸ“Š **æ¸¬è©¦ç”¨ä¾‹**

ä¿®å¾©å¾Œï¼Œä»¥ä¸‹æ™‚é–“æ ¼å¼éƒ½èƒ½æ­£ç¢ºè™•ç†ï¼š

### **æˆåŠŸè§£æçš„æ ¼å¼**
```python
âœ… "2025-07-28 01:57:31"           â†’ 2025-07-28 09:57:31 (å°åŒ—æ™‚é–“)
âœ… "2025-08-06 20:58:48.063065"    â†’ 2025-08-07 04:58:48 (å°åŒ—æ™‚é–“)
âœ… "2025-08-07T04:07:39.690356"    â†’ 2025-08-07 12:07:39 (å°åŒ—æ™‚é–“)
âœ… "2024-02-23 18:13:24"           â†’ 2024-02-24 02:13:24 (å°åŒ—æ™‚é–“)
âœ… "2025-08-06T20:10:44.955344Z"   â†’ 2025-08-07 04:10:44 (å°åŒ—æ™‚é–“)
```

### **éŒ¯èª¤è™•ç†**
```python
âŒ "invalid-time-string"           â†’ None â†’ å›é€€åˆ°å­—ç¬¦ä¸²é¡¯ç¤º
âŒ "2025-13-45 25:70:99"          â†’ None â†’ å›é€€åˆ°å­—ç¬¦ä¸²é¡¯ç¤º
âŒ ""                             â†’ None â†’ é¡¯ç¤º'N/A'
```

## ğŸš€ **æ€§èƒ½å’Œç©©å®šæ€§**

### **æ€§èƒ½æ”¹é€²**
- **å¤šé‡å˜—è©¦**ï¼šå¿«é€Ÿå¤±æ•—ï¼ŒæŒ‰å¸¸è¦‹æ ¼å¼å„ªå…ˆç´šæ’åº
- **å­—ç¬¦ä¸²é è™•ç†**ï¼šæ¸›å°‘ä¸å¿…è¦çš„è§£æå˜—è©¦
- **ç·©å­˜å‹å¥½**ï¼šè§£ææˆåŠŸå¾Œç›´æ¥è¿”å›

### **ç©©å®šæ€§æå‡**
- **ç„¡ç•°å¸¸æ‹‹å‡º**ï¼šæ‰€æœ‰éŒ¯èª¤éƒ½è¢«æ•ç²å’Œè™•ç†
- **å„ªé›…é™ç´š**ï¼šè§£æå¤±æ•—æ™‚æä¾›å¯è®€çš„å›é€€é¡¯ç¤º
- **è©³ç´°æ—¥èªŒ**ï¼šä¿ç•™èª¿è©¦ä¿¡æ¯ä½†ä¸å½±éŸ¿åŠŸèƒ½

---

**ä¿®å¾©å®Œæˆæ™‚é–“**ï¼š2025-08-07  
**å½±éŸ¿ç¯„åœ**ï¼š`ui/components/playwright_utils.py` + `playwright_data_export_handler.py`  
**ä¿®å¾©é¡å‹**ï¼šæ™‚é–“è§£æå…¼å®¹æ€§ + éŒ¯èª¤è™•ç† + ç”¨æˆ¶é«”é©—
