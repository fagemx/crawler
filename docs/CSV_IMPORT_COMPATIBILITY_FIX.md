# ğŸ”§ CSV å°å…¥å…¼å®¹æ€§ä¿®å¾©å ±å‘Š

## âŒ **åŸå§‹å•é¡Œ**

ç”¨æˆ¶åé¥‹ï¼š
```
ğŸš€ å¯¦æ™‚æ™ºèƒ½çˆ¬èŸ² ä¸Šå‚³CSV ä¹Ÿæœ‰å•é¡Œ
âŒ CSVæ ¼å¼ä¸æ­£ç¢ºï¼Œç¼ºå°‘æ¬„ä½: views
```

ç”¨æˆ¶ä½¿ç”¨çš„CSVæ–‡ä»¶ï¼š`user_posts_netflixtw_20250807_063556.csv`

## ğŸ” **å•é¡Œåˆ†æ**

### **å¤šçµ„ä»¶æ¬„ä½è¦æ±‚ä¸ä¸€è‡´**
ç™¼ç¾ç³»çµ±ä¸­æœ‰4å€‹çµ„ä»¶éƒ½æœ‰CSVå°å…¥åŠŸèƒ½ï¼Œä½†å®ƒå€‘çš„æ¬„ä½è¦æ±‚å„ä¸ç›¸åŒï¼š

| çµ„ä»¶ | å¿…éœ€æ¬„ä½ | å•é¡Œ |
|------|----------|------|
| `realtime_crawler_component.py` | `['username', 'post_id', 'content', 'views']` | âŒ å¼·åˆ¶è¦æ±‚ `views` |
| `playwright_crawler_component.py` | `['username', 'post_id', 'content', 'views']` | âŒ å¼·åˆ¶è¦æ±‚ `views` |
| `playwright_crawler_component_refactored.py` | `['username', 'post_id', 'content', 'views']` | âŒ å¼·åˆ¶è¦æ±‚ `views` |
| `playwright_data_export_handler.py` | `['url', 'post_id', 'username', 'content']` | âŒ å¼·åˆ¶è¦æ±‚ `url` |

### **å¯¦éš›CSVæ–‡ä»¶æ ¼å¼**
æª¢æŸ¥å¯¦éš›å°å‡ºçš„CSVæ–‡ä»¶æ ¼å¼ï¼š
```csv
username,post_id,url,content,views,likes,comments,reposts,shares,source,created_at,fetched_at
```

### **æ¬„ä½åç¨±è®ŠåŒ–**
ä¸åŒç³»çµ±å¯èƒ½ä½¿ç”¨ä¸åŒçš„æ¬„ä½åç¨±ï¼š
- æœ‰äº›CSVä½¿ç”¨ `views`ï¼Œæœ‰äº›ä½¿ç”¨ `views_count`
- æœ‰äº›åŒ…å« `url`ï¼Œæœ‰äº›ä¸åŒ…å«
- æ¬„ä½çš„å­˜åœ¨æ€§å› å°å‡ºä¾†æºè€Œç•°

## âœ… **ä¿®å¾©æ–¹æ¡ˆ**

### **çµ±ä¸€éˆæ´»é©—è­‰ç­–ç•¥**
ç‚ºæ‰€æœ‰4å€‹çµ„ä»¶å¯¦æ–½ç›¸åŒçš„éˆæ´»é©—è­‰é‚è¼¯ï¼š

#### **1. æ ¸å¿ƒå¿…è¦æ¬„ä½**
åªè¦æ±‚çµ•å°å¿…éœ€çš„æ ¸å¿ƒæ¬„ä½ï¼š
```python
core_required = ['username', 'post_id', 'content']
```

#### **2. å¯é¸æ¬„ä½è™•ç†**
å°æ–¼å¯é¸æ¬„ä½ï¼Œæä¾›æ™ºèƒ½é è¨­å€¼ï¼š
```python
optional_columns = ['views', 'url', 'likes_count', 'comments_count', 'reposts_count', 'shares_count']
for col in optional_columns:
    if col not in df.columns:
        if col == 'views':
            df[col] = df.get('views_count', 0)  # å˜—è©¦ä½¿ç”¨ views_count
        elif col == 'url':
            df[col] = ''  # URLå¯ä»¥ç‚ºç©º
        else:
            df[col] = 0  # æ•¸å€¼æ¬„ä½é è¨­ç‚º 0
```

#### **3. æ™ºèƒ½æ¬„ä½æ˜ å°„**
- `views` â† `views_count`ï¼ˆè‡ªå‹•æ˜ å°„ï¼‰
- ç¼ºå¤±çš„æ•¸å€¼æ¬„ä½ â†’ `0`
- ç¼ºå¤±çš„æ–‡å­—æ¬„ä½ â†’ `''`

## ğŸ“Š **ä¿®å¾©ç¯„åœ**

### **ä¿®å¾©çš„çµ„ä»¶**
1. âœ… **realtime_crawler_component.py**
   - ç§»é™¤å¼·åˆ¶ `views` è¦æ±‚
   - æ·»åŠ éˆæ´»é©—è­‰é‚è¼¯
   - æ”¯æ´ `views_count` â†’ `views` æ˜ å°„

2. âœ… **playwright_crawler_component.py**
   - ç§»é™¤å¼·åˆ¶ `views` è¦æ±‚
   - æ·»åŠ éˆæ´»é©—è­‰é‚è¼¯
   - æ”¯æ´å¯é¸æ¬„ä½é è¨­å€¼

3. âœ… **playwright_crawler_component_refactored.py**
   - ç§»é™¤å¼·åˆ¶ `views` è¦æ±‚
   - æ·»åŠ éˆæ´»é©—è­‰é‚è¼¯
   - çµ±ä¸€é©—è­‰ç­–ç•¥

4. âœ… **playwright_data_export_handler.py**
   - ç§»é™¤å¼·åˆ¶ `url` è¦æ±‚
   - æ·»åŠ éˆæ´»é©—è­‰é‚è¼¯
   - æ”¯æ´å¤šç¨®æ¬„ä½çµ„åˆ

## ğŸ¯ **ä¿®å¾©æ•ˆæœ**

### **ä¿®å¾©å‰çš„éŒ¯èª¤è¡Œç‚º**ï¼š
```bash
âŒ ä¸åŒçµ„ä»¶è¦æ±‚ä¸åŒæ¬„ä½
âŒ å¼·åˆ¶è¦æ±‚å¯é¸æ¬„ä½ï¼ˆå¦‚ viewsã€urlï¼‰
âŒ ç„¡æ³•è™•ç†æ¬„ä½åç¨±è®ŠåŒ–ï¼ˆviews vs views_countï¼‰
âŒ CSVå°å…¥ç¶“å¸¸å¤±æ•—
âŒ ç”¨æˆ¶é«”é©—ä¸ä¸€è‡´
```

### **ä¿®å¾©å¾Œçš„æ­£ç¢ºè¡Œç‚º**ï¼š
```bash
âœ… æ‰€æœ‰çµ„ä»¶ä½¿ç”¨çµ±ä¸€é©—è­‰é‚è¼¯
âœ… åªè¦æ±‚æ ¸å¿ƒå¿…è¦æ¬„ä½
âœ… æ™ºèƒ½è™•ç†å¯é¸æ¬„ä½å’Œæ¬„ä½æ˜ å°„
âœ… CSVå°å…¥æˆåŠŸç‡å¤§å¹…æå‡
âœ… ä¸€è‡´çš„ç”¨æˆ¶é«”é©—
```

## ğŸ”„ **æ”¯æ´çš„CSVæ ¼å¼**

ä¿®å¾©å¾Œï¼Œç³»çµ±æ”¯æ´ä»¥ä¸‹æ‰€æœ‰CSVæ ¼å¼ï¼š

### **å®Œæ•´æ ¼å¼**
```csv
username,post_id,url,content,views,likes,comments,reposts,shares
```

### **æœ€å°æ ¼å¼**
```csv
username,post_id,content
```

### **è®ŠåŒ–æ ¼å¼**
```csv
username,post_id,content,views_count,likes_count  # views_count è‡ªå‹•æ˜ å°„ç‚º views
username,post_id,url,content                      # ç¼ºå¤±æ¬„ä½è‡ªå‹•è£œ0
```

## ğŸš€ **å…¼å®¹æ€§æå‡**

### **æ¬„ä½æ˜ å°„è¦å‰‡**
- `views_count` â†’ `views`
- `likes` â†’ `likes_count`
- `comments` â†’ `comments_count`
- `reposts` â†’ `reposts_count`
- `shares` â†’ `shares_count`

### **é è¨­å€¼ç­–ç•¥**
- **æ•¸å€¼æ¬„ä½**ï¼šé è¨­ç‚º `0`
- **æ–‡å­—æ¬„ä½**ï¼šé è¨­ç‚º `''`
- **URLæ¬„ä½**ï¼šé è¨­ç‚º `''`ï¼ˆå¯é¸ï¼‰

### **éŒ¯èª¤è™•ç†**
- åªæœ‰ç¼ºå°‘æ ¸å¿ƒæ¬„ä½æ™‚æ‰å ±éŒ¯
- æä¾›æ¸…æ¥šçš„æˆåŠŸè¼‰å…¥è¨Šæ¯
- é¡¯ç¤ºè¼‰å…¥çš„è¨˜éŒ„æ•¸é‡

## ğŸ“‹ **æ¸¬è©¦å ´æ™¯**

ä¿®å¾©å¾Œï¼Œä»¥ä¸‹å ´æ™¯éƒ½æ‡‰è©²æ­£å¸¸å·¥ä½œï¼š

1. âœ… **å®Œæ•´CSVæ–‡ä»¶**ï¼šåŒ…å«æ‰€æœ‰æ¬„ä½
2. âœ… **æœ€å°CSVæ–‡ä»¶**ï¼šåªåŒ…å«æ ¸å¿ƒæ¬„ä½
3. âœ… **æ¬„ä½åç¨±è®ŠåŒ–**ï¼šä½¿ç”¨ä¸åŒçš„æ¬„ä½åç¨±
4. âœ… **éƒ¨åˆ†æ¬„ä½ç¼ºå¤±**ï¼šè‡ªå‹•è£œå……é è¨­å€¼
5. âœ… **è·¨çµ„ä»¶ä½¿ç”¨**ï¼šåŒä¸€CSVå¯åœ¨ä¸åŒçµ„ä»¶ä¸­ä½¿ç”¨

---

**ä¿®å¾©å®Œæˆæ™‚é–“**ï¼š2025-08-07  
**å½±éŸ¿ç¯„åœ**ï¼š4å€‹çµ„ä»¶çš„CSVå°å…¥åŠŸèƒ½  
**ä¿®å¾©é¡å‹**ï¼šå…¼å®¹æ€§æ”¹é€² + éˆæ´»é©—è­‰ + çµ±ä¸€æ¨™æº–
